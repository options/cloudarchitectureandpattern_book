# API Gateway 설계 패턴 구현 과제

## 과제 제목 : 모바일 금융 서비스를 위한 API Gateway 설계 및 구현

### 시나리오

당신은 핀테크 스타트업 **“FinNow”**의 API 인프라 엔지니어입니다. 회사는 최근 다양한 금융 기능을 제공하는 모바일 앱을 출시했습니다. 이 앱은 다음과 같은 **마이크로서비스 아키텍처**로 구성되어 있습니다:

* **User Service**: 로그인, 사용자 정보 관리
* **Account Service**: 계좌 정보, 잔액 조회
* **Transfer Service**: 계좌 이체
* **Card Service**: 카드 사용 내역 조회 및 정지 요청
* **Investment Service**: 투자 상품 목록 및 잔고 조회

하지만, 현재 모바일 앱이 각 서비스를 직접 호출하고 있어 다음 문제가 발생하고 있습니다:

1. 모든 서비스에서 인증 로직이 중복 구현되어 있음
2. 네트워크가 느린 환경에서 앱 성능 저하
3. 보안 로그 및 API 모니터링이 통합되지 않음

이러한 문제를 해결하기 위해 API Gateway를 도입하려고 합니다.

### 과제 요구사항

아래 항목을 포함하는 **API Gateway 시스템을 설계하고 프로토타입을 구축**하세요:

1. **API Gateway 아키텍처 설계**

   * 어떤 오픈소스를 사용할 것인지 선정 (예: Kong, NGINX, Express Gateway 등)
   * 라우팅 구조 정의 (예: `/api/v1/accounts`, `/api/v1/transfer` 등)
   * 마이크로서비스와의 연결 구조 (백엔드 서비스와 게이트웨이 간 통신 방식)

2. **인증 처리**

   * JWT 또는 OAuth2 방식으로 단일 인증을 구현하고, 이를 게이트웨이에서 검증
   * 사용자 인증이 필요한 서비스만 제한하도록 설정

3. **요청/응답 변환 (선택)**

   * `/dashboard` API는 여러 서비스(User, Account, Investment)로부터 데이터를 받아 병합된 JSON 형태로 응답 제공

4. **보안 및 로깅**

   * 요청 IP, 사용자 정보, 응답 상태코드, 응답 시간 등을 로깅
   * 인증 실패 시 적절한 응답 반환

5. **테스트 및 문서화**

   * Postman 또는 Swagger를 사용해 API 문서 작성
   * 사용 시나리오 기반 테스트 시나리오 작성

### 제출물

* 설계 문서 (아키텍처 다이어그램 포함)
* API Gateway 구성 파일 또는 코드
* 샘플 API 로그 출력
* 테스트 케이스 및 실행 결과
* 발표용 PPT (요약: 문제 → 해결 방안 → 구현 결과)

### 보너스 미션 (심화학습자용)

* **Rate Limiting 기능 구현** (예: 초당 5건 이상 요청 시 차단)
* **CORS 정책 설정**
* **HTTPS 리버스 프록시 구성**
* **Grafana/Loki 또는 ELK 스택을 활용한 API 모니터링**

물론입니다. 이번에는 **이커머스 플랫폼**을 배경으로 한 시나리오 중심의 과제를 소개합니다. API Gateway가 왜 필요한지, 어떤 문제를 해결하는지에 집중할 수 있도록 구성했습니다.

### 과제 제목

**"이커머스 플랫폼의 API Gateway 구축을 통한 서비스 통합과 최적화"**

### 시나리오

당신은 온라인 쇼핑몰 플랫폼 **"EZShop"**의 백엔드 개발자로 참여하고 있습니다. 회사는 빠르게 성장하고 있으며, 기능별로 마이크로서비스를 분리한 다음과 같은 구조로 운영 중입니다:

* **Product Service**: 상품 목록, 상세정보 제공
* **Cart Service**: 장바구니 추가/삭제
* **Order Service**: 주문 생성, 주문 내역 조회
* **User Service**: 회원가입, 로그인, 프로필 수정
* **Payment Service**: 결제 요청, 결제 상태 조회

현재 프론트엔드 앱은 각 서비스를 직접 호출하고 있으며, 다음과 같은 문제에 직면해 있습니다:

1. 클라이언트에서 여러 API를 순차적으로 호출해야 하므로 성능 저하
2. 서비스별로 인증/로그인 처리 방식이 달라 일관성 부족
3. 비즈니스 로직이 서비스 간 중복되어 유지보수 어려움
4. 보안 관련 정책이 서비스마다 다르게 적용되어 있음

운영팀은 **API Gateway**를 도입하여 프론트엔드와 백엔드 간의 통합 진입점을 만들고, 보안과 효율성을 향상시키고자 합니다.

### 과제 요구사항

아래 조건을 만족하는 API Gateway 시스템을 설계하고 시뮬레이션 또는 프로토타입을 구현하세요.

1. **API Gateway 도입 설계**

   * 어떤 오픈소스/서비스를 사용할지 결정하고 선정 이유 설명
   * 클라이언트 → 게이트웨이 → 각 서비스로의 라우팅 구조 설계
   * BFF(Backend for Frontend) 방식 적용 여부 판단

2. **기능 통합 예제 구현**

   * `/checkout` 엔드포인트 구현: 장바구니 조회 → 주문 생성 → 결제 요청까지 한 번에 처리
   * 이 과정에서 Product, Cart, Order, Payment 서비스와 통신

3. **인증 처리 통합**

   * 로그인 후 발급받은 토큰을 API Gateway에서 검증하고, 내부 서비스는 신뢰된 요청으로 간주
   * 인증이 필요한 서비스에만 접근 허용

4. **요청 제한 및 로깅 기능 추가**

   * IP 또는 사용자 기준 Rate Limiting
   * 요청 경로, 응답 시간, 상태 코드 등을 로그 파일로 출력

5. **오류 처리**

   * 각 서비스의 오류를 공통된 포맷(JSON)으로 감싸서 클라이언트에 응답하도록 구성
   * 예: `{"status": 500, "error": "Cart service unavailable"}`

### 제출물

* 설계 문서 (아키텍처 다이어그램 포함)
* API Gateway 구성 코드 및 샘플 마이크로서비스 Mock
* `/checkout` 호출 시 흐름 설명 자료
* 테스트 결과 캡처 또는 시연 동영상
* 기술 요약 발표 자료

### 심화 도전 과제 (선택)

* 프론트엔드 앱에서 호출하는 API를 모두 `/api/v1/` 하위에 통합하여 CORS 정책 적용
* 각 사용자 그룹(일반 사용자, 관리자 등)에 따른 API 접근 제어 정책 구성
* Swagger 또는 Postman을 활용해 전체 API 명세서 제작

