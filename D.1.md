# API Gateway 설계 패턴 실전 사례

### 실전 사례: 이커머스 플랫폼의 API 게이트웨이 적용

#### 배경

A사는 다양한 서비스를 제공하는 이커머스 플랫폼(상품, 주문, 결제, 사용자 관리 등)을 마이크로서비스 기반으로 운영하고 있었습니다. 모바일 앱과 웹 프론트엔드가 다수의 백엔드 서비스에 요청을 보내야 했고, API 호출이 점점 복잡해지면서 다음과 같은 문제에 직면했습니다:

* 각 마이크로서비스에 대해 클라이언트가 직접 통신해야 하므로 복잡성과 보안 이슈가 증가
* 다양한 클라이언트(Android, iOS, Web)에 맞는 응답 형식을 일일이 조정해야 함
* 인증, 로깅, 요청 제한(throttling), CORS 처리 등을 각 서비스에 반복적으로 구현해야 함

#### 해결 방법

API Gateway 패턴을 도입하여 클라이언트와 내부 마이크로서비스 사이에 **API Gateway**를 배치함으로써 아래와 같은 이점을 얻었습니다.

#### 구조

```
[Web/Mobile Client]  
        ↓  
[API Gateway (Kong / AWS API Gateway / NGINX)]  
        ↓  
[User Service]  
[Product Service]  
[Order Service]  
[Payment Service]
```

#### API Gateway 역할

* **라우팅**: `/users`, `/products` 등의 요청을 해당 마이크로서비스로 전달
* **인증 및 권한 검증**: JWT 기반 인증 토큰 검증을 Gateway에서 수행
* **요청/응답 변환**: 프론트엔드에 맞게 응답 포맷 통합 (GraphQL 형태로 변환하기도 함)
* **속도 제한 및 로깅**: DDOS 방지 및 보안 모니터링을 위한 로깅 및 rate limiting
* **캐싱**: 정적 데이터나 빈번히 요청되는 상품 정보를 Gateway 레벨에서 캐싱하여 응답속도 향상

### 적용 효과

| 개선 전                      | 개선 후                              |
| ------------------------- | --------------------------------- |
| 프론트엔드가 여러 마이크로서비스와 직접 통신  | API Gateway가 중계함으로써 클라이언트 코드를 단순화 |
| 인증/로깅/제한 기능을 각 서비스에 반복 구현 | API Gateway에서 공통 처리하여 개발 중복 제거    |
| 보안 및 API 관리 미흡            | 중앙 집중형 API 정책 적용으로 관리 용이          |

### 참고: 실제 서비스에서의 API Gateway 도입 사례

1. **Netflix**: Zuul을 통해 수백 개의 마이크로서비스 트래픽을 조절하고 모니터링
2. **Amazon**: AWS API Gateway를 통해 인증, 쓰로틀링, 라우팅 등을 관리
3. **Kakao**: 내부 OpenAPI와 외부 공개 API를 Kong 기반 게이트웨이로 통합

물론입니다. 이번에는 **금융 서비스(FinTech)** 분야에서의 API 게이트웨이 패턴 실전 사례를 소개하겠습니다.

### 실전 사례: 모바일 뱅킹 앱의 API 게이트웨이 적용

#### 배경

B사는 모바일 뱅킹 앱을 운영하는 핀테크 기업으로, 다양한 기능(계좌조회, 송금, 카드관리, 투자, 고객센터 등)을 여러 마이크로서비스로 분리하여 운영하고 있었습니다. 사용자는 하나의 앱을 통해 다양한 기능을 사용하는데, 다음과 같은 문제에 직면했습니다:

* 각 기능(예: 계좌 조회, 송금 등)에 대해 별도의 인증 절차 필요 → 사용자 경험 저하
* 모바일 네트워크 환경에서 여러 백엔드 호출이 느려지고 불안정함
* 서비스마다 감사 로그, 보안 검사, 모니터링 로직이 중복 구현되어 유지보수 비용 증가

#### 해결 방법

API Gateway를 도입하여 **모바일 앱과 백엔드 서비스들 사이의 단일 진입점**으로 설정하고, 다음과 같은 기능을 통합 처리했습니다.

---

#### 구조

```
[Mobile Banking App]  
        ↓  
[API Gateway (Apigee / AWS API Gateway / Kong)]  
        ↓  
[Account Service]  
[Transfer Service]  
[Card Management Service]  
[Investment Service]  
[Customer Support Service]
```

#### API Gateway 주요 기능

* **단일 인증 처리**: OAuth2 + JWT 기반 인증을 Gateway에서 통합 처리하여 로그인 상태 유지
* **응답 병합 (aggregation)**: 대시보드에서 계좌잔액, 최근 거래내역, 투자요약을 한번에 표시할 수 있도록 여러 서비스 응답을 하나로 통합
* **모바일 최적화**: 느린 네트워크 환경에서도 동작할 수 있도록 gzip 압축 및 rate limiting
* **감사 로깅 및 모니터링**: 사용자 요청 경로, IP, API 응답 코드 등을 통합 로깅하여 이상 징후 탐지
* **실시간 정책 변경**: 특정 API의 접근을 시간대나 사용자 권한에 따라 제한 가능 (예: 심야 시간 송금 제한)

### 적용 효과

| 이전 문제                | API Gateway 도입 후        |
| -------------------- | ----------------------- |
| 인증 중복, 기능별로 로그인 필요   | 단일 인증 토큰으로 모든 기능 접근     |
| 앱에서 여러 API 호출로 UX 저하 | Gateway에서 응답 병합 → 빠른 응답 |
| 서비스 간 보안 로직 중복       | 중앙에서 보안정책 일괄 적용         |
| 감사 로그 누락, 관리 어려움     | 통합 로깅 및 모니터링 체계 확립      |

### 실제 참고 사례

* **신한은행 SOL 앱**: 다양한 기능을 하나의 앱에서 통합 제공하기 위해 API Gateway + BFF (Backend-for-Frontend) 패턴 적용
* **토스(Toss)**: Kong 기반 API Gateway를 활용해 인증, 보안, 응답 최적화를 수행
* **Stripe**: 외부 API 제공을 위해 API Gateway에서 속도 제한, 권한 제어, 오용 방지 기능을 구현


